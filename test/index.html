<!DOCTYPE html>

<html>
    <head>
        <meta charset="UTF-8">
        <title>Mmap</title>
        <meta name="description" content="Electron app to draw original mind maps">
        <link href="test.css" rel="stylesheet">
    </head>
    <body>

        <div class="sidebar">
            <h3>mmap.js</h3>
            <table>
                <tr>
                    <td>Node name :</td>
                    <td><input id="node-name" type="text" name="node-name"></td>
                </tr>
                <tr>
                    <td>Font size :</td>
                    <td><input id="font-size" type="text" name="font-size"></td>
                </tr>
                <tr>
                    <td>Bold font :</td>
                    <td><img onclick="mmap.updateNode('font-weight')" src="img/bold.svg"></td>
                </tr>
                <tr>
                    <td>Italic font :</td>
                    <td><img onclick="mmap.updateNode('font-style')" src="img/italic.svg"></td>
                </tr>
                <tr>
                    <td>Undo :</td>
                    <td><img onclick="mmap.undo()" src="img/undo.svg"></td>
                </tr>
                <tr>
                    <td>Repeat :</td>
                    <td><img onclick="mmap.repeat()" src="img/repeat.svg"></td>
                </tr>
                <tr>
                    <td>Add node :</td>
                    <td><img onclick="mmap.addNode()" src="img/add.svg"></td>
                </tr>
                <tr>
                    <td>Remove node :</td>
                    <td><img onclick="mmap.removeNode()" src="img/remove.svg"></td>
                </tr>
                <tr>
                    <td>Center :</td>
                    <td><img onclick="mmap.center()" src="img/center.svg"></td>
                </tr>
                <tr>
                    <td>New map :</td>
                    <td><img onclick="mmap.newMap()" src="img/new.svg"></td>
                </tr>
                <tr>
                    <td>Get image :</td>
                    <td><img onclick="mmap.getPNG('mmap')" src="img/img.svg"></td>
                </tr>
                <tr>
                    <td>Node color :</td>
                    <td><input class="color-btn" type="color" name="background-color"
                        onchange="mmap.updateNode('background-color', value)"></td>
                </tr>
                <tr>
                    <td>Branch color :</td>
                    <td><input class="color-btn" type="color" name="branch-color"
                        onchange="mmap.updateNode('branch-color', value)"></td>
                </tr>
                <tr>
                    <td>Text color :</td>
                    <td><input class="color-btn" type="color" name="text-color"
                        onchange="mmap.updateNode('text-color', value)"></td>
                </tr>
            </table>
        </div>

        <div class="mmap"></div>

        <script src="../bower_components/d3/d3.min.js"></script>
        <script src="../dist/mmap.js"></script>
        <script>

            // DOM elements
            const nodeName = document.getElementById('node-name');
            const fontSize = document.getElementById('font-size');
            const backgroundColor = document.getElementsByClassName('color-btn')[0];
            const branchColor = document.getElementsByClassName('color-btn')[1];
            const textColor = document.getElementsByClassName('color-btn')[2];

            fontSize.onkeyup = function() {
                mmap.updateNode('font-size', fontSize.value );
            }

            fontSize.onkeydown = function( e ) {
                e.stopPropagation();
            }

            nodeName.onblur = function() {
                if( nodeName.value === '' ) mmap.updateNode('name', nodeName.value = 'Node');
            }

            nodeName.onkeyup = function( e ) {
                mmap.updateNode('name', nodeName.value );
            };

            nodeName.onkeydown = function( e ) {
                e.stopPropagation();
                e.key === "Enter" && nodeName.blur();
            }

            // mmap events

            mmap.events.on('mmcreate', function(){
                console.info('Mindmap created!');
            });

            mmap.events.on('nodeselect', function( n ) {
                nodeName.value = n['name'];
                fontSize.value = n['font-size'];
                backgroundColor.value = n['background-color'];
                branchColor.value = n['branch-color'] || '#ffffff';
                textColor.value = n['text-color'];
            });

            mmap.events.on('nodedblclick', function( n ) {
                nodeName.focus();
            });

            mmap.init('.mmap');

        </script>
    </body>
</html>
